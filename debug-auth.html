<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ØªØ´Ø®ÙŠØµ Ù†Ø¸Ø§Ù… Ø§Ù„Ù…ØµØ§Ø¯Ù‚Ø©</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <style>
        body { padding: 20px; font-family: Arial, sans-serif; }
        .debug-box { background: #f8f9fa; padding: 15px; border-radius: 8px; margin: 10px 0; }
        .success { color: green; }
        .error { color: red; }
        .info { color: blue; }
    </style>
</head>
<body>
    <div class="container">
        <h1>ğŸ” ØªØ´Ø®ÙŠØµ Ù†Ø¸Ø§Ù… Ø§Ù„Ù…ØµØ§Ø¯Ù‚Ø©</h1>
        
        <div class="debug-box">
            <h5>Ø­Ø§Ù„Ø© localStorage:</h5>
            <div id="localStorageStatus"></div>
        </div>
        
        <div class="debug-box">
            <h5>Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… Ø§Ù„Ù…Ø­ÙÙˆØ¸Ø©:</h5>
            <div id="userData"></div>
        </div>
        
        <div class="debug-box">
            <h5>Ø§Ù„ØµÙØ­Ø© Ø§Ù„Ø­Ø§Ù„ÙŠØ©:</h5>
            <div id="currentPage"></div>
        </div>
        
        <div class="debug-box">
            <h5>Ø¥Ø¬Ø±Ø§Ø¡Ø§Øª:</h5>
            <button class="btn btn-danger" onclick="clearUserData()">Ù…Ø³Ø­ Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…</button>
            <button class="btn btn-success" onclick="testLogin()">Ù…Ø­Ø§ÙƒØ§Ø© ØªØ³Ø¬ÙŠÙ„ Ø¯Ø®ÙˆÙ„</button>
            <button class="btn btn-info" onclick="refreshData()">ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª</button>
        </div>
        
        <div class="debug-box">
            <h5>Ø±ÙˆØ§Ø¨Ø· Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø±:</h5>
            <a href="login.html" class="btn btn-primary">ØµÙØ­Ø© ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„</a>
            <a href="admin.html" class="btn btn-warning">ØµÙØ­Ø© Ø§Ù„Ø¥Ø¯Ø§Ø±Ø©</a>
            <a href="index.html" class="btn btn-secondary">Ø§Ù„ØµÙØ­Ø© Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©</a>
        </div>
    </div>

    <script>
        const USER_STORAGE_KEY = 'ma3ab_current_user';
        
        function refreshData() {
            // Ø­Ø§Ù„Ø© localStorage
            const savedUser = localStorage.getItem(USER_STORAGE_KEY);
            const localStorageDiv = document.getElementById('localStorageStatus');
            
            if (savedUser) {
                localStorageDiv.innerHTML = '<span class="success">âœ… ÙŠÙˆØ¬Ø¯ Ø¨ÙŠØ§Ù†Ø§Øª Ù…Ø­ÙÙˆØ¸Ø©</span>';
            } else {
                localStorageDiv.innerHTML = '<span class="error">âŒ Ù„Ø§ ØªÙˆØ¬Ø¯ Ø¨ÙŠØ§Ù†Ø§Øª Ù…Ø­ÙÙˆØ¸Ø©</span>';
            }
            
            // Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…
            const userDataDiv = document.getElementById('userData');
            if (savedUser) {
                try {
                    const user = JSON.parse(savedUser);
                    userDataDiv.innerHTML = `
                        <div class="success">
                            <strong>Ø§Ø³Ù… Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…:</strong> ${user.username}<br>
                            <strong>Ø§Ù„Ø§Ø³Ù… Ø§Ù„ÙƒØ§Ù…Ù„:</strong> ${user.fullName}<br>
                            <strong>Ø§Ù„Ø¯ÙˆØ±:</strong> ${user.role}<br>
                            <strong>Ø§Ù„Ù…Ø¹Ø±Ù:</strong> ${user.id}
                        </div>
                    `;
                } catch (error) {
                    userDataDiv.innerHTML = '<span class="error">âŒ Ø®Ø·Ø£ ÙÙŠ Ù‚Ø±Ø§Ø¡Ø© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª: ' + error.message + '</span>';
                }
            } else {
                userDataDiv.innerHTML = '<span class="info">â„¹ï¸ Ù„Ø§ ØªÙˆØ¬Ø¯ Ø¨ÙŠØ§Ù†Ø§Øª Ù…Ø³ØªØ®Ø¯Ù…</span>';
            }
            
            // Ø§Ù„ØµÙØ­Ø© Ø§Ù„Ø­Ø§Ù„ÙŠØ©
            const currentPageDiv = document.getElementById('currentPage');
            const currentPage = window.location.pathname.split('/').pop();
            currentPageDiv.innerHTML = `<span class="info">ğŸ“„ ${currentPage || 'index.html'}</span>`;
        }
        
        function clearUserData() {
            localStorage.removeItem(USER_STORAGE_KEY);
            alert('ØªÙ… Ù…Ø³Ø­ Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…');
            refreshData();
        }
        
        function testLogin() {
            const testUser = {
                id: 'test123',
                username: 'admin',
                fullName: 'Ø§Ù„Ù…Ø´Ø±Ù Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠ',
                phone: '1234567890',
                role: 'admin'
            };
            
            localStorage.setItem(USER_STORAGE_KEY, JSON.stringify(testUser));
            alert('ØªÙ… Ø­ÙØ¸ Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ø®ØªØ¨Ø§Ø±');
            refreshData();
        }
        
        // ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø¹Ù†Ø¯ ØªØ­Ù…ÙŠÙ„ Ø§Ù„ØµÙØ­Ø©
        window.addEventListener('load', refreshData);
        
        // ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª ÙƒÙ„ Ø«Ø§Ù†ÙŠØ©
        setInterval(refreshData, 1000);
    </script>
</body>
</html>
